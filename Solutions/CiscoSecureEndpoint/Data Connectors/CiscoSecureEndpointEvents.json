{
    "kind": "APIPolling",
    "properties": {
        "connectorUiConfig": {
            "id": "CiscoSecureEndpointEvents",
            "title": "Cisco Secure Endpoint",
            "publisher": "Cisco",
            "descriptionMarkdown": "The Cisco Secure Endpoint data connector provides the capability to ingest [Cisco Secure Endpoint events](https://api-docs.amp.cisco.com/api_actions/details?api_action=GET+%2Fv1%2Fevents&api_host=api.amp.cisco.com&api_resource=Event&api_version=v1) into Azure Sentinel.",
            "graphQueriesTableName": "CiscoSecureEndpoint_events_CL",
            "graphQueries": [
                {
                    "metricName": "Total data received",
                    "legend": "Cisco SE events",
                    "baseQuery": "{{graphQueriesTableName}}"
                }
            ],
            "sampleQueries": [
                {
                    "description": "All Cisco SE events",
                    "query": "{{graphQueriesTableName}}\n| sort by TimeGenerated desc"
                }
            ],
            "dataTypes": [
                {
                    "name": "{{graphQueriesTableName}}",
                    "lastDataReceivedQuery": "{{graphQueriesTableName}}\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
                }
            ],
            "connectivityCriterias": [
                {
                    "type": "SentinelKindsV2",
                    "value": []
                }
            ],
            "availability": {
                "status": 1,
                "isPreview": true
            },
            "permissions": {
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "read and write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "write": true,
                            "read": true,
                            "delete": true
                        }
                    },
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                        "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key)",
                        "providerDisplayName": "Keys",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "action": true
                        }
                    }
                ],
                "customs": [
                    {
                        "name": "Cisco Secure Endpoint API credentials",
                        "description": "Cisco Secure Endpoint Client ID and API Key are required. [See the documentation to learn more about Cisco Secure Endpoint API](https://api-docs.amp.cisco.com/api_resources?api_host=api.amp.cisco.com&api_version=v1). [API domain](https://api-docs.amp.cisco.com) must be provided as well."
                    }
                ]
            },
            "instructionSteps": [
                {
                    "title": "Connect Cisco Secure Endpoint",
                    "description": "Please inset your credentials",
                    "instructions": [
                        {
                            "parameters": {
                                "enable": "true",
                                "userRequestPlaceHoldersInput": [
                                    {
                                        "displayText": "Domain Name",
                                        "requestObjectKey": "apiEndpoint",
                                        "placeHolderName": "{{domain}}",
                                        "placeHolderValue": ""
                                    }
                                ]
                            },
                            "type": "BasicAuth"
                        }
                    ]
                }
            ]
        },
        "pollingConfig": {
            "auth": {
                "authType": "Basic"
            },
            "request": {
                "apiEndpoint": "https://{{domain}}/v1/events",
                "httpMethod": "Get",
                "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
                "startTimeAttributeName": "start_date",
                "queryWindowInMin": 5
            },
            "paging": {
                "pagingType": "None"
            },
            "response": {
                "eventsJsonPaths": [
                    "$..data"
                ]
            }
        }
    }
}